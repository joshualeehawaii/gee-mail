<html>
	<head>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
		<title>Death Star Internal Communications System</title>
    <script>
      window.onload = function(){
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser

        //OBJECTIVE (4) MAKING A VISUAL LIST OF THE INTIAL 10 EAMILS
        for (var i = 0; i<window.geemails.length; i++){
        	//console.log(window.geemails);
        	//console.log(window.geemails[i]);
        	//console.log(window.geemails[i].date);
        	//console.log(window.geemails[i].subject);
        	//console.log(window.geemails[i].sender);
        	//console.log(window.geemails[i].body);

          	var emailDate = document.createElement("div");
          	emailDate.className = "date";
          	emailDate.innerHTML = window.geemails[i].date;
          	main.appendChild(emailDate);

          	var emailSender = document.createElement("div");
          	emailSender.className = "from";
          	emailSender.innerHTML = window.geemails[i].sender;
          	emailDate.appendChild(emailSender);

          	var emailSubject = document.createElement("div");
          	emailSubject.className = "info";
          	emailSubject.innerHTML = window.geemails[i].subject;
          	emailDate.appendChild(emailSubject);

          	var emailBody = document.createElement("div");
          	emailBody.className = "read";
          	emailBody.innerHTML = window.geemails[i].body;
          	emailBody.style.display = "none";
          	emailDate.appendChild(emailBody);
    	}

    	//OBJECTIVE (4) CONT. ADDING THE EVENT LISTNER TO SHOW/HIDE EAMAIL CONTENT WHEN CLICKED ON
		var showMessage = document.getElementsByClassName("date");
		for(var j = 0; j<showMessage.length; j++){
  		//console.log(showMessage[j]);
			showMessage[j].addEventListener("click", readEmail);   
		}

		function readEmail(){
 			var emailContent = this.querySelectorAll(".read")[0];
  				if (emailContent.style.display === "none"){
    				emailContent.style.display = "block";
  				}else{
    			emailContent.style.display = "none";
    			}
    	}

    	//OBJECTIVE (5) ADDING THE INBOX COUNTER TO THE PAGE
        var emailCounter = 0;
        function showNumberEmails(emails){
        	for (var k = 0; k<emails.length; k++){
        		emailCounter = emails.length;
        	}
        }
        showNumberEmails(window.geemails);
        //console.log(emailCounter);

        var showEmail = document.createElement("div");
        showEmail.className = "count";
        showEmail.innerHTML = emailCounter;
        counter.appendChild(showEmail);

        // OBJECTIVE (6) SETTING THE RECURRING FUNCTION TO PULL NEW EMAILS
        function getNewEmail(){
      		var newEmails = getNewMessage();
      		window.geemails.push(newEmails);
      		//document.getElementById("counter").innerHTML = emailCounter;
      		//console.log(emailCounter); 
      		//console.log(newEmails);
      		//console.log(newEmails.date);
      		//console.log(newEmails.subject);
      		//console.log(newEmails.sender);
      		//console.log(newEmails.body);

      		var emailDate = document.createElement("div");
      		emailDate.className = "date";
      		emailDate.innerHTML = newEmails.date;
      		main.appendChild(emailDate);

      		var emailSender = document.createElement("div");
      		emailSender.className = "from";
      		emailSender.innerHTML = newEmails.sender;
      		emailDate.appendChild(emailSender);

      		var emailSubject = document.createElement("div");
      		emailSubject.className = "info";
      		emailSubject.innerHTML = newEmails.subject;
      		emailDate.appendChild(emailSubject);

      		var emailBody = document.createElement("div");
      		emailBody.className = "read";
      		emailBody.innerHTML = newEmails.body;
      		emailBody.style.display = "none";
      		emailDate.appendChild(emailBody);

    		//THIS FOR-LOOP WILL ADD THE EVENT LISTENER TO THE BODY OF THE NEW EMAILS
    		var showMessage = document.getElementsByClassName("date");
    		for(var j = 0; j<showMessage.length; j++){
      			//console.log(showMessage[j]);
    			showMessage[j].addEventListener("click", readEmail);
    		}
    		//this function will find the number of emails in the inbox
        	var newEmailCounter = 0;
        	function showNumberEmails(emails){
          		for (var k = 0; k<emails.length; k++){
            		emailCounter = emails.length;
          		}
        	}
        	//INVOKING THE FUNCTION
        	showNumberEmails(window.geemails);
        	//console.log(emailCounter);

        	//ADDING NEW NUMBER OF EMAILS TO THE PAGE
        	var showEmail = document.getElementById("counter");
        	showEmail.className = "count";
        	showEmail.innerHTML = emailCounter;
    
    	} 
    	setInterval(getNewEmail, 7000);
        
     };
    </script>
	</head>
	<body>
		<div id="counter"></div>
		<div class="container" id="main">
			Build Me!
		</div>
	</body>
</html>